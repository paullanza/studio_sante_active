<div class="container mt-4">
  <h1 class="mb-3">Adjustments Preview</h1>

  <% if @rows.present? %>
    <%= form_with url: admin_adjustments_commit_path, method: :post, local: true do %>
      <div class="row g-2 align-items-end mb-3">
        <div class="col-md-6">
          <label for="employee_id" class="form-label">Assign adjustments to</label>
          <%= select_tag :employee_id,
                options_from_collection_for_select(@users_for_select, :id, :full_name),
                include_blank: "Select an employee",
                class: "form-select",
                required: true %>
        </div>
        <div class="col-md-6 text-end">
          <%= hidden_field_tag :payload, @payload_json %>
          <%= submit_tag "Commit Adjustments",
                class: "btn btn-primary",
                data: { turbo_confirm: "Create adjustments for the selected employee? This cannot be undone." } %>
        </div>
      </div>
    <% end %>

    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <% @headers.each do |h| %>
              <th><%= h %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @rows.each do |r| %>
            <tr>
              <% @headers.each do |h| %>
                <td><%= r[h] %></td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="text-muted">No rows found in the CSV.</p>
  <% end %>

  <div class="mt-3">
    <%= link_to "Back", admin_adjustments_new_path, class: "btn btn-secondary" %>
  </div>
</div>
